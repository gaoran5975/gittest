<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>北京国际摄影周2018线上新闻中心</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">

   <style>
		*{margin:0;padding:0;}
        html, body {
            position: relative;
            height: 100%;
			font-size:100px;
        }
        body {
            background: #eee;
            font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
            font-size: 62.5%;
            color:#000;
            margin: 0;
            padding: 0;
        }
		.wrap{
			margin:0 auto;
			position:relative;

		}
		p{font-size: 0.3rem;}

		p.navSet {
			position: fixed;
			width: 100%;
			height: 7%;
			bottom: 0;
			left: 0;
			background: #000;
			z-index: 3;
		}
		.navSet a {
			display: inline-block;
			width: 32%;
			height: 100%;
			line-height: 0.8rem;
			text-align: center;
			font-size: 0.31rem;
			color: #fff;
			text-decoration: none;
			font-weight: bold;
			letter-spacing: 2px;
		}
		.navSet a:nth-child(2){
			background: #bf0a07;
		}



		.list26 {
			height: 300px;
			position: relative;
		}
		.list26 li {
			position: absolute;
			top: 0;
			left: 0;
			list-style: none;
			overflow: hidden;
			text-align: center;
			height: 250px;
		}
		.list26 li img {
			width:auto;
			height:100%;
			max-height:100%;
		}
		.list26 li a.title{
			display: none;
		}
		a.curTitle {
			background: #c00a07;
			display: block;
			padding: 10px;
			color: #fff;
			font-size: 0.3rem;
			text-decoration: none;
			position: absolute;
			top: 250px;
			width: 88%;
			left: 4%;
		}
		.list26 .btn3dPrev,.list26 .btn3dNext{
			display:none;
		}
		.slider3d{
			padding: 20px 0;
			margin-top: -10px;
		}

		h3.titleGallary {
			width: 94%;
			margin: 10px auto;
			font-size: 0.35rem;
			text-align: center;
			color: #fff;
			background: #000;
			padding: 8px 0;
			font-weight: normal;
		}
		.gallaryIntro {
			width: 94%;
			margin: 0 auto;
			font-size: 0.35rem;
		}
		.gallaryIntro p {
			font-size: 0.34rem;
			line-height: 1.8em;
		}
		.fieldSet {
			width: 90%;
			margin: 10px auto;
			background: #fefefe;
			font-size: 0.3rem;
			padding: 2%;
			line-height: 2em;
			margin-bottom: 80px;
			overflow: auto;
		}
		.fieldSet dd, dt {
			float: left;
		}
		.fieldSet dt {
			clear: both;
		}

		.thumbTank {
			overflow: scroll;
		}
		.thumbPic {

		}
		.thumbPic li {
			/*width: 120px; */
			list-style: none;
			float: left;
			margin-right: 10px;
		}
		
		.thumbPic li img {
			width: 100%;
			width:auto;
			height:72px;
		}
		img.bigPic {
			width: auto;
			height:100%;
		}
		.popWin{
			background: rgba(0, 0, 0, 0.8) none repeat scroll 0 0 !important;
			-ms-filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#33000000,endColorstr=#33000000);
			filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#33000000,endColorstr=#33000000);
			position: absolute;
			top:0;
			left:0;
			width:100%;
			z-index:10000;
			display:none;
		}
		p.thumbTitle {
			height: 30px;
			color: #fff;
			text-align: center;
		}
		.bigPicTank {
			height: 300px;
			overflow: hidden;
			margin-top: 80px;
			text-align: center;
			background: #000;
		}
		@media screen and (min-width:320px){
			html{font-size:42.6px;}
		}
		@media screen and (min-width:360px){
			html{font-size:48px;}
		}
		@media screen and (min-width:375px){
			html{font-size:50px;}
		}
		@media screen and (min-width:384px){
			html{font-size:51.2px;}
		}
		@media screen and (min-width:400px){
			html{font-size:53.3px;}
		}
		@media screen and (min-width:414px){
			html{font-size:55.2px;}
		}
		@media screen and (min-width:424px){
			html{font-size:56.5px;}
		}
		@media screen and (min-width:480px){
			html{font-size:64px;}

		}
		@media screen and (min-width:540px){
			html{font-size:72px;}
		}
		@media screen and (min-width:600px){
			html{font-size:80px;}
		}
		@media screen and (min-width:720px){
			html{font-size:96px;}
		}
		@media screen and (min-width:750px){
			html{font-size:100px;}
		}
		@media screen and (min-width:800px){
			html{font-size:107px;}
		}
		@media screen and (min-width:1024px){
			html{font-size:136px;}
		}
    </style>


</head>
<body id="pageWonderful">
	<div class="wrap" id="wrap">
		<h3 class="titleGallary"><span class="gallaryName" id="gallaryName"></span><span class="author"></span></h3>
		<div class="slider3d">
			<div class="list26">
				<ul class="clearfix" id="topSlider">

<!-- 					<li class="initSize">
						<a href="#" class="pic" target="_blank">
							<img src="images/wonderful_test2.jpg" alt="">
						</a>
						<a href="#" class="jiaodai title" target="_blank">盘点老北京10大铜锅涮肉火锅店1盘点老北京10大铜锅涮肉火锅店1</a>
					</li>
					<li>
						<a href="http://food.qianlong.com/2015/0727/1700.shtml" class="pic" target="_blank">
							<img src="images/wonderful_test2.jpg" width="600" height="320" alt="">
						</a>
						<a href="http://food.qianlong.com/2015/0727/1700.shtml" class="jiaodai title" target="_blank">盘点老北京10大铜锅涮肉火锅店2</a>
					</li>
					<li>
						<a href="http://food.qianlong.com/2015/0727/1700.shtml" class="pic" target="_blank">
							<img src="images/wonderful_test2.jpg" width="600" height="320" alt="">
						</a>
						<a href="http://food.qianlong.com/2015/0727/1700.shtml" class="jiaodai title" target="_blank">盘点老北京10大铜锅涮肉火锅店3</a>
					</li>
					<li>
						<a href="http://food.qianlong.com/2015/0727/1700.shtml" class="pic" target="_blank">
							<img src="images/wonderful_test2.jpg" width="600" height="320" alt="">
						</a>
						<a href="http://food.qianlong.com/2015/0727/1700.shtml" class="jiaodai title" target="_blank">盘点老北京10大铜锅涮肉火锅店4</a>
					</li>
					<li>
						<a href="http://food.qianlong.com/2015/0727/1700.shtml" class="pic" target="_blank">
							<img src="images/wonderful_test2.jpg" width="600" height="320" alt="">
						</a>
						<a href="http://food.qianlong.com/2015/0727/1700.shtml" class="jiaodai title" target="_blank">盘点老北京10大铜锅涮肉火锅店5</a>
					</li> -->


				</ul>
				<a href="#" class="curTitle"></a>
				<a href="#" class="btn3dPrev">prev</a>
				<a href="#" class="btn3dNext">next</a>
			</div><!--end list26-->
		</div><!--end slider3d-->

		<div class="gallaryIntro" id="gallaryIntro">
		</div>
		<div class="fieldSet">
			<dl>
				<dt>策展人/策展机构：</dt><dd class="field1" id="exhibit_org"></dd>
				<dt>策展人语：</dt><dd class="field1" id="exhibit_lang"></dd>
				<dt>策展人/策展机构简介：</dt><dd class="field1" id="exhibit_org_desc"></dd>
				<dt>摄影师简介：</dt><dd class="field1" id="exhibit_photographer_desc"></dd>
				<dt>国家：</dt><dd class="field1" id="exhibit_country"></dd>
				<dt>展品规格：</dt><dd class="field1" id="exhibit_spec"></dd>
				<dt>展品数量：</dt><dd class="field1" id="exhibit_amount"></dd>
				<dt>提供方式：</dt><dd class="field1" id="exhibit_provide"></dd>
			</dl>
		</div>
		<p class="navSet">
			<a href="http://partner.qianlong.com/bjipw//h5/bjipw/index.html">新闻中心</a>
			<a href="#" id="return">&lt;&lt;返回</a>
			<a href="http://vphotos.cn/7Heh">官方图库</a>
		</p>
		<div class="popWin">
			<div class="lunbo">
				<div class="bigPicTank"><img src="#" alt="" class="bigPic"/></div>
				<div class="thumbTank">
					<ul class="thumbPic" id="thumbPic">

<!-- 						<li><img src="images/news_p2Test1.jpg" alt="aa"/></li>
						<li><img src="images/news_p2Test2.jpg" alt="bb"/></li>
						<li><img src="images/news_p2Test3.jpg" alt="click"/></li>
						<li><img src="images/news_p2Test4.jpg" alt="dd"/></li>
						<li><img src="images/news_p2Test1.jpg" alt="ee"/></li>
						<li><img src="images/news_p2Test2.jpg" alt="ff"/></li>
						<li><img src="images/news_p2Test3.jpg" alt="gg"/></li> -->

					</ul>
				</div>
				<p class="thumbTitle"></p>
			</div><!--end lunbo-->
		</div><!--end popWin-->
	</div>




<script src="/h5/bjipw/lib/jquery-1.8.3.min.js"></script>
<script src="/h5/bjipw/lib/TweenMax.min.js"></script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>


<script>
    var vh=$(window).height();
    var vw=$(window).width();
    var imgRatio=750/1206;
	console.log(vh);

	var Request = new Object();
	Request = GetRequest();
	
	/*-------------组件26----------------*/
	(function() {

	if(Request['galid'] != null){
		$.ajax({
			type: "get",
			async: true,
			url: "/bjipw/api/get_single_gallary?galid=" + Request['galid'],
			dataType: "json",
			success: function(json){
				var d = eval("(" + json + ")");

				$("#gallaryName").html(d.exhibit_name);
				$("#gallaryIntro").html('<br><p>' + d.content + '</p>');
				$("#exhibit_org").html(d.exhibit_org);
				$("#exhibit_lang").html(d.exhibit_lang);
				$("#exhibit_org_desc").html(d.exhibit_org_desc);
				$("#exhibit_photographer_desc").html(d.exhibit_photographer_desc);
				$("#exhibit_country").html(d.exhibit_country);
				$("#exhibit_spec").html(d.exhibit_spec);
				$("#exhibit_amount").html(d.exhibit_amount);
				$("#exhibit_provide").html(d.exhibit_provide);

				var _li = '';
				var size = 5;
				if(d.imglist.length < size) size = d.imglist.length;
				for(var i=0; i<size; i++){
					var sub = d.imglist[i];
					if(i==0){
						_li += '<li class="initSize">'
						_li += '<img src="' + sub.img_url + '" alt="">'
						_li += '<a href="#" class="jiaodai title" target="_blank">' + sub.img_string
						_li += '</a>'
						_li += '</li>'
					}
					else{
						_li += '<li>'
						_li += '<img src="' + sub.img_url + '" alt="">'
						_li += '<a href="#" class="jiaodai title" target="_blank">' + sub.img_string
						_li += '</a>'
						_li += '</li>'						
					}
				}
				$("#topSlider").html('');
				$("#topSlider").html(_li);

				var _li2 = '';
				for(var i=0; i<d.imglist.length; i++){
					var sub = d.imglist[i];
					_li2 += '<li><img src="' + sub.img_url + '" alt="' + sub.img_string + '"/></li>'
				}
				$("#thumbPic").html('');
				$("#thumbPic").html(_li2);


				if ($('.list26').size() > 0) {

					var list26_arrayPos = new Array();
					var list26_numPic = $('.list26 li').size();
					var list26_tankW = parseInt($('.list26').parent().width());
					var list26_picW = parseInt($('.list26 .initSize').css('width'));
					var list26_picH = parseInt($('.list26 .initSize').css('height'));
					var list26_ratioWh = list26_picH / list26_picW;

					if ($(window).width() < 767) {
						list26_picW = $(window).width() * 0.7;
						list26_picH = list26_picW * list26_ratioWh;
					}
					$('.list26 li').removeClass('initSize');
					console.log(list26_ratioWh);

					var list26_radius = $('.list26').parent().width() * 0.4 / 2; //容器宽度的80%
					var list26_angleStep = Math.PI * 2 / list26_numPic;

					function markCircle() {
						for (var i = 0; i < list26_numPic; i++) {
							var tmpW = parseInt((Math.cos(list26_angleStep * i) + 2) / 3 * list26_picW);
							var tmpPosX = parseInt(list26_radius * Math.sin(list26_angleStep * i));
							list26_arrayPos[i] = new Object();
							list26_arrayPos[i].w = tmpW;
							list26_arrayPos[i].h = parseInt(tmpW * list26_ratioWh);
							list26_arrayPos[i].zIdx = tmpW;
							list26_arrayPos[i].x = tmpPosX;
							list26_arrayPos[i].opa = (Math.cos(list26_angleStep * i) + 2) / 3;
							//console.log(list26_arrayPos[i].h);

						}
					}

					function initPic() {
						for (var i = 0; i < list26_numPic; i++) {
							$('.list26 li').eq(i).css('width', list26_arrayPos[i].w);
							$('.list26 li').eq(i).css('height', list26_arrayPos[i].h);
							$('.list26 li').eq(i).css('z-index', list26_arrayPos[i].zIdx);
							$('.list26 li').eq(i).css('left', list26_arrayPos[i].x - list26_arrayPos[i].w / 2 + list26_tankW / 2);
							$('.list26 li').eq(i).css('top', (list26_picH - list26_arrayPos[i].h) / 12);
							$('.list26 li').eq(i).css('opacity', list26_arrayPos[i].opa);
							$('.list26 li').eq(i).attr('dataCurPos', i);
							$('.list26 li').eq(i).css('height', 220);
							//console.log($('.list26 li').eq(i).css('height'))
						}
						$('.list26 a.btn3dNext,.list26 a.btn3dPrev').css('top', list26_arrayPos[0].h / 2 - 25)
						var $theLink=$('.list26 li:first').find('a');
						$('.curTitle').text(cutstr($theLink.text(),96));
						$('.curTitle').attr('href',$theLink.attr('href'));
					}

					function moveNext() {
						$('.list26 li').each(function() {
							var nextPos = (parseInt($(this).attr('dataCurPos')) + 1) % list26_numPic;
							$(this).animate({
								left: list26_arrayPos[nextPos].x - list26_arrayPos[nextPos].w / 2 + list26_tankW / 2,
								top: (list26_picH - list26_arrayPos[nextPos].h) / 12,
								width: list26_arrayPos[nextPos].w,
								height: 220,
								opacity: list26_arrayPos[nextPos].opa
							}, 500, function() {
								$(this).css('z-index', list26_arrayPos[nextPos].zIdx);
								$(this).attr('dataCurPos', nextPos);
								var $theLink=$('.list26 li[dataCurPos="0"]').find('a');
								$('.curTitle').text(cutstr($theLink.text(),96));
								$('.curTitle').attr('src',$theLink.attr('src'));
							})
						})

					}

					function movePrev() {
						$('.list26 li').each(function() {
							var nextPos = (parseInt($(this).attr('dataCurPos')) + list26_numPic - 1) % list26_numPic;
							$(this).animate({
								left: list26_arrayPos[nextPos].x - list26_arrayPos[nextPos].w / 2 + list26_tankW / 2,
								top: (list26_picH - list26_arrayPos[nextPos].h) / 12,
								width: list26_arrayPos[nextPos].w,
								height: 220,
								opacity: list26_arrayPos[nextPos].opa
							}, 500, function() {
								$(this).css('z-index', list26_arrayPos[nextPos].zIdx);
								$(this).attr('dataCurPos', nextPos);
								var $theLink=$('.list26 li[dataCurPos="0"]').find('a');
								$('.curTitle').text(cutstr($theLink.text(),96));
								$('.curTitle').attr('href',$theLink.attr('href'));

							})
						})
					}
					var iv;
					function autoPlaySlider(){
						iv=setInterval(movePrev,2000);
					}

					markCircle();
					initPic();
					autoPlaySlider();
					$('.list26 a.btn3dNext').click(function() {
						moveNext();
						return false;
					})
					$('.list26 a.btn3dPrev').click(function() {
						movePrev();
						return false;
					})
				}			

				$('.popWin').height(vh);
				var picNum=$('.thumbPic li').size();
				var picW=$('.thumbPic li').css('width');
				var picGap=$('.thumbPic li').css('margin-right');
				var totalW=0;
				$('.thumbPic li img').each(function(){
					var img=new Image();
					var $this=$(this);
					img.src=$this.attr('src');
					img.onload=function(){
						var origW=img.width;
						var origH=img.height;
						var cssH=parseInt($('.thumbPic li img').css('height'));
						var curW=cssH*origW/origH;
						var curWG=curW+parseInt(picGap);
						totalW+=curWG;
						$('.thumbPic').width(totalW);
						$this.attr('width',origW);
						$this.attr('height',origH);
						$('.bigPic').attr('src',($('.thumbPic li:first').find('img').attr('src')));
						$('.bigPic').attr('width',($('.thumbPic li:first').find('img').attr('width')));
						$('.bigPic').attr('height',($('.thumbPic li:first').find('img').attr('height')));
						$('.thumbTitle').text($('.thumbPic li:first').find('img').attr('alt'));
						updateBigPicSize();
					}
				})
				
				function updateBigPicSize(){
					var bigW=$('.bigPic').attr('width');
					var bigH=$('.bigPic').attr('height');
					if(bigW>bigH){
						$('.bigPic').css('width','100%');
						$('.bigPic').css('height','auto');
						$('.bigPic').css('margin-top',(parseInt($('.bigPicTank').css('height'))-$('.bigPic').height())/2);
					}else{
						$('.bigPic').css('height','100%');
						$('.bigPic').css('width','auto');
						$('.bigPic').css('margin-top',0);
					}
					
				}
				$('.thumbPic li img').click(function(){
					$('.bigPic').attr('src',$(this).attr('src'));
					$('.bigPic').attr('width',$(this).attr('width'));
					$('.bigPic').attr('height',$(this).attr('height'));
					updateBigPicSize();
					$('.thumbTitle').text($(this).attr('alt'));
					event.stopPropagation();
				})

				$('.list26 a').click(function(){
					$('.popWin').show();
					return false;
				})
				$('.popWin').click(function(){
					$(this).hide();

				})
				
				function cutstr(str, len) {
					var str_length = 0;
					var str_len = 0;
					str_cut = new String();
					str_len = str.length;
					for (var i = 0; i < str_len; i++) {
						a = str.charAt(i);
						str_length++;
						if (escape(a).length > 4) {
							//中文字符的长度经编码之后大于4
							str_length++;
						}
						str_cut = str_cut.concat(a);
						if (str_length >= len) {
							str_cut = str_cut.concat("...");
							return str_cut;
						}
					}
					//如果给定字符串小于指定长度，则返回源字符串；
					if (str_length < len) {
						return str;
					}
				}

			},
			error: function(){
			}
		});
	}	



	})();




	//微信分享缩略图
	$.ajax({
		type: "get",
		async: true,
		url: "http://partner.qianlong.com/api/weixin/share/qianlong",
		dataType: "jsonp",
		data: {
			"weburl": location.href.split("#")[0]
		},
		success: function(json){
			wx.config({
				debug: false,
				appId: json.appId,
				timestamp: json.timestamp,
				nonceStr: json.nonceStr,
				signature: json.signature,
				jsApiList: ['onMenuShareAppMessage', 'onMenuShareTimeline', 'onMenuShareQQ', 'onMenuShareWeibo', 'onMenuShareQZone']
			});
		},
		error: function(){
			console.log("share error");
		}
	});

	wx.ready(function(){
		console.log("ready to share");
		var obj_co = {
					title: "北京国际摄影周2018线上新闻中心",
					link: "http://partner.qianlong.com/h5/bjipw/",
					imgUrl: "http://partner.qianlong.com/h5/bjipw/images/thumbShare.png",
					success: function(){
					},
					cancel: function(){}
				},
				obj_co_desc = {
					desc: "北京国际摄影周2018联合千龙网-中国首都网出品"
				},
				obj_timeline = $.extend({}, obj_co),
				obj_appmsg = $.extend({}, obj_co_desc, obj_co),
				obj_qq = $.extend({}, obj_co_desc, obj_co),
				obj_wb = $.extend({}, obj_co_desc, obj_co),
				obj_qzone = $.extend({}, obj_co_desc, obj_co);

		wx.onMenuShareTimeline(obj_timeline);
		wx.onMenuShareAppMessage(obj_appmsg);
		wx.onMenuShareQQ(obj_qq);
		wx.onMenuShareWeibo(obj_wb);
		wx.onMenuShareQZone(obj_qzone);
	});

	wx.error(function(res){
		console.log(res.errMsg);
		//alert(res.errMsg);
	});		
	
	function GetRequest() {
	   var url = location.search; //获取url中"?"符后的字串
	   var theRequest = new Object();
	   if (url.indexOf("?") != -1) {
	      var str = url.substr(1);
	      strs = str.split("&");
	      for(var i = 0; i < strs.length; i ++) {
	         theRequest[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1]);
	      }
	   }
	   return theRequest;
	}

    $(document).on("click", "#return", function() {
        location.href = '/h5/bjipw/listGallary.html?catid=' + Request['catid'];
    });



</script>
</body>
</html>