<!DOCTYPE html>
<html lang="en">
<head>
  <title>“北京组工”公众号2周年调研</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <meta name="viewport" content="width=device-width,user-scalable=no" />
  <script src="http://g.tbcdn.cn/mtb/lib-flexible/0.3.4/??flexible_css.js,flexible.js"></script> 

  <link rel="stylesheet" href="http://partner.qianlong.com/static/libs/swiper/swiper.min.css">
  <link rel="stylesheet" href="http://partner.qianlong.com/static/libs/swiper/animate.min.css">
  <link rel="stylesheet" href="css/main.css">
   <!-- <link rel="stylesheet" href="css/style.css"> -->
   <style>
		*{margin:0;padding:0;}
		html,body(width:100%;height:100%;)
		body{background:#000;}
		.container {
			width: 100%; height: 100%;
			margin: auto;
			background-color: #fff;
			position: relative;
		}
		.container > img {
			position: absolute;
			width: 100%; height: 100%;    
			left:0;
			top:0;
		}

		.loadingBar {
			position: absolute;
			top: 30%;
			left: 10%;
			height: 20px;
			border-bottom: solid 10px #FF5722;
			color: #ff5622;
			text-align: center;
			z-index: 2;
			width:0;
			font-size:14px;
		}
		a.btnEnter{
			position:absolute;
			width:20%;
			left:40%;
			top:40%;
		}
		a.btnEnter img {
			width: 100%;
		}
		.swiper-container{z-index:10;position:relative;}
		.btnEnter{display:none;}
		.videoTank {
			width: 100%; height: 100%;
			margin: auto;
			background-color: #fff;
			position: relative;
		}
		.videoTank > img {
			position: absolute;
			width: 100%; height: 100%;    
			left:0;
			top:0;
		}
   </style
</head>
<body>

<div id="container" class="container">
	<div class="loadingBar"><span class="txtPercent">0</span>%</div>
	<a href="#" class="btnEnter"><img src="images/btnEnter.png"/></a>
</div>
<div  id="videoTank" class="videoTank"></div>
<div class="swiper-container">
  <div class="swiper-wrapper">
    
    <div class="swiper-slide home">
      <img src="images/dh.png" class="dh">
      <img src="images/txt1.png" class="txt txt1">
      <img src="images/txt2.png" class="txt txt2">
      <img src="images/txt3.png" class="txt txt3">
      <img src="images/txt4.png" class="txt txt4">
      <img src="images/txt5.png" class="txt txt5">
      <img src="images/txt6.png" class="txt txt6">
      <img src="images/txt7.png" class="txt txt7">
      <img src="images/txt8.png" class="txt txt8">
      <img src="images/txt9.png" class="txt txt9">
      <img src="images/txt10.png" class="txt txt10">

      <div class="up">陪我继续</div>
    </div>

   

    <div class="swiper-slide p1 section swiper-no-swiping">
      <img src="images/qs1.png" alt="" class="qs1">
      <div class="page-wrapper">
        <div class="option-group">
          <ul class="option-list">
            <li class="item" rel="A">A. 大事要闻</li>
            <li class="item" rel="B">B. 组工动态</li>
            <li class="item" rel="C">C. 组工文化</li>
            <li class="item" rel="D">D. 政策解读</li>
            <li class="item" rel="E">E. 任前公示</li>
            <li class="item" rel="F">F. 党务知识</li>
            <div class="other-box">
              <span class="other-text">G. 其他</span>
              <input type="text" class="other" placeholder="写下您的建议，我们努力实现">

              <div class="text-box">
                <textarea name="" class="textarea" placeholder="写下您的建议，我们努力实现"></textarea>
                
              </div>
            </div>
          </ul>
          <span class="submit" id="sub" rel="1">提交</span>
        </div>
      </div>
    </div>

    <div class="swiper-slide p2 section swiper-no-swiping">
      <img src="images/qs2.png" alt="" class="qs1">
      <div class="page-wrapper">
        <div class="option-group">
          <ul class="option-list">
            <li class="item" rel="A">A. 普通图文</li>
            <li class="item" rel="B">B. 图说图解</li>
            <li class="item" rel="C">C. 语音播报</li>
            <li class="item" rel="D">D. 视频动漫</li>
            <li class="item" rel="E">E. H5</li>
            <div class="other-box">
              <span class="other-text">E. 其他</span>
              <input type="text" class="other" placeholder="写下您的建议，我们努力实现">

              <div class="text-box">
                <textarea name="" class="textarea" id="" placeholder="写下您的建议，我们努力实现"></textarea>
                
              </div>
            </div>
          </ul>
          <span class="submit" id="sub" rel="2">提交</span>
        </div>
      </div>
    </div>

    <div class="swiper-slide p3 section swiper-no-swiping">
      <img src="images/qs3.png" alt="" class="qs1">
      <div class="page-wrapper">
        <div class="option-group">
          <ul class="option-list">
            <li class="item" rel="A">A. 7时至9时</li>
            <li class="item" rel="B">B. 12时至14时</li>
            <li class="item" rel="C">C. 18时至20时</li>
            <li class="item" rel="D">D. 21时至23时</li>
            <div class="other-box">
              <span class="other-text">E. 其他</span>
              <input type="text" class="other" placeholder="写下您的建议，我们努力实现">

              <div class="text-box">
                <textarea name="" class="textarea" id="" placeholder="写下您的建议，我们努力实现"></textarea>
                
              </div>
            </div>
          </ul>
          <span class="submit" id="sub" rel="3">提交</span>
        </div>
      </div>
    </div>

    <div class="swiper-slide p4 section swiper-no-swiping">
      <img src="images/qs4.png" alt="" class="qs1">
      <div class="page-wrapper">
        <div class="option-group">
          <ul class="option-list">
            <li class="item" rel="A">A. 搜索公众号名称</li>
            <li class="item" rel="B">B. 阅读文章后关注</li>
            <li class="item" rel="C">C. 朋友推荐</li>
            <li class="item" rel="D">D. 单位推广</li>
            <div class="other-box">
              <span class="other-text">E. 其他</span>
              <input type="text" class="other" placeholder="写下您的建议，我们努力实现">

              <div class="text-box">
                <textarea name="" class="textarea" id="" placeholder="写下您的建议，我们努力实现"></textarea>
                
              </div>
            </div>
          </ul>
          <span class="submit" id="sub" rel="4">提交</span>
        </div>
      </div>
    </div>

    <div class="swiper-slide p5 section swiper-no-swiping">
      <img src="images/qs5.png" alt="" class="qs1">
      <div class="page-wrapper">
        <div class="option-group">
          
          <div class="text-box">
            <textarea name="" class="textarea" id="" placeholder="写下您的建议，我们努力实现"></textarea>
              
          </div>
          
          <span class="submit" id="sub1">提交</span>
        </div>
      </div>
    </div>
    
    <div class="swiper-slide impress section">
      <img src="images/yinxiang.png" alt="" class="qs1">
      <div class="page-wrapper">
        <div class="item-box">
          <ul class="item-list" id="zanlist">
          </ul>
        </div>
      </div>
      <div class="up"></div>
    </div>

    <div class="swiper-slide section end">
      <img src="images/end.png" class="end-img">
      <div class="btn-group">
        <span class="again btn" id="again">再填一次</span>
        <span class="share btn" id="share">分享</span>
      </div>

      <div class="share-mask">
        <img src="images/share.png" class="share-img">
      </div>
    </div>

    <div class="swiper-slide swiper-no-swiping answer">
      <div class="page-wrapper2">
        <span class="title" id="rtitle">1.你最希望看到“北京组工”推送哪些内容？</span>

        <ul class="result-list" id="result-list">
        </ul>

        <div class="next" id="next">
          <span>下一题</span>
        </div>
      </div>
    </div>
    
  </div>
  <div class="swiper-pagination"></div>
</div>


<script src="http://partner.qianlong.com/static/libs/jquery-1.8.3.min.js "></script>
<script src="js/libgif.js"></script>
<script src="http://partner.qianlong.com/static/libs/swiper/swiper.min.js "></script>
<script src="http://img.qianlong.com/templates/qianlong/common/lib/howler.min.js"></script>
<script src="http://partner.qianlong.com/static/libs/swiper/swiper.animate1.0.2.min.js "></script>
<script src="http://partner.qianlong.com/static/libs/jweixin-1.0.0.js "></script>
<script>

 var sndBgd=new Howl({
	src: ['gif12.mp3'],
	autoplay: false,
	loop: true,
	volume: 0.4,
	onload: function() {
		console.log("snd loaded");

		
	}
})
var vw=$(window).width();
var vh=$(window).height();
var barW=vw*0.8;
var urlRoot = 'images/img/';
var indexRange = [1, 185];
var maxLength = indexRange[1] - indexRange[0] + 1;
// loading
var eleContainer = document.getElementById('videoTank');
// 存储预加载的DOM对象和长度信息
var store = {
    length: 0    
};
// 图片序列预加载
for ( var start = indexRange[0]; start <= indexRange[1]; start++) {
    (function (index) {
        var img = new Image();
        img.onload = function () {
            store.length++;
            // 存储预加载的图片对象
            store[index] = this;
            play();
        };
        img.onerror = function () {
            store.length++;    
            play();
        };
        img.src = urlRoot + index + '.png';
    })(start);    
}

var play = function () {
    // loading进度
    var percent = Math.round(100 * store.length / maxLength);
	console.log(percent);
	$('.txtPercent').html(percent);
	$('.loadingBar').width(percent*barW/100);

    // 全部加载完毕，无论成功还是失败
    if (percent == 100) {
		$('.btnEnter').fadeIn(300);
		$('.btnEnter').css('display','block');
    }
	
};

$('.btnEnter').click(function(){
		sndBgd.play();
		$('.container').fadeOut(1400);
		$('.videoTank img, .videoTank').height(vh);
        var index = indexRange[0];
        // 依次append图片对象
        var step = function () {
            if (store[index - 1]) {
                eleContainer.removeChild(store[index - 1]);
            }    
            eleContainer.append(store[index]);
            // 序列增加
            index++;
            // 如果超过最大限制
            if (index <= indexRange[1]) {
                setTimeout(step, 72);
            } else {
                // 本段播放结束回调
				console.log("序列播放完毕");
				sndBgd.stop();
				$('.videoTank').fadeOut(800);
			}
			
        };
        // 等100%动画结束后执行播放
        setTimeout(step, 1400);
	})
</script>
<script src="js/main.js"></script>



<script type="text/javascript">   

  var userid;
  var nextpage;

  //一般情况下，这样就可以自动播放了，但是一些奇葩iPhone机不可以 
  // document.getElementById('car_audio').play(); 
  //必须在微信Weixin JSAPI的WeixinJSBridgeReady才能生效 
  // document.addEventListener("WeixinJSBridgeReady", function () { 
  //   document.getElementById('car_audio').play(); 
  //   document.getElementById('video').play(); 
  // }, false); 


  $.ajax({
    type: "get",
    async: true,
    url: "/bjzg2an/api/get_userid",
    success: function(json){
      userid = eval('(' + json + ')');
    },
    error: function(){
      console.log("server error");
    }
  });


  $.ajax({
    type: "get",
    async: true,
    url: "http://partner.qianlong.com/api/weixin/share/qianlong",
    dataType: "jsonp",
    data: {
      "weburl": location.href.split("#")[0]
    },
    success: function(json){
      //console.log(json);
      wx.config({
        debug: false,
        appId: json.appId,
        timestamp: json.timestamp,
        nonceStr: json.nonceStr,
        signature: json.signature,
        jsApiList: ['onMenuShareAppMessage', 'onMenuShareTimeline', 'onMenuShareQQ', 'onMenuShareWeibo', 'onMenuShareQZone']
      });
    },
    error: function(){
      console.log("share error");
    }
  });

  wx.ready(function(){
    console.log("ready to share");
    var obj_co = {
          title: "H5|北京组工公众号2周年调研",
          link: "http://partner.qianlong.com/h5/bjzg2an",
          imgUrl: "http://partner.qianlong.com/h5/bjzg2an/images/main_img.jpg",
          success: function(){
          },
          cancel: function(){}
        },
        obj_co_desc = {
          desc: "告诉我，你愿意陪我走下去吗？"
        },
        obj_timeline = $.extend({}, obj_co),
        obj_appmsg = $.extend({}, obj_co_desc, obj_co),
        obj_qq = $.extend({}, obj_co_desc, obj_co),
        obj_wb = $.extend({}, obj_co_desc, obj_co),
        obj_qzone = $.extend({}, obj_co_desc, obj_co);

    wx.onMenuShareTimeline(obj_timeline);
    wx.onMenuShareAppMessage(obj_appmsg);
    wx.onMenuShareQQ(obj_qq);
    wx.onMenuShareWeibo(obj_wb);
    wx.onMenuShareQZone(obj_qzone);
  });

  wx.error(function (res) {
    console.log(res.errMsg);
    //alert(res.errMsg);
  });

</script>





</body>
</html>